<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Chat box Trường CĐ CNTT TP.HCM">
    <meta name="keywords" content="Chatbot, AI, Trả lời tự động">
    <meta name="author" content="Trường CĐ CNTT TP. HCM">
    <meta property="og:title" content="CĐ CNTT TP. HCM">
    <meta property="og:description" content="Chat box Trường CĐ CNTT TP.HCM">
    <meta property="og:image" content="./image/logoitc.png">
    <meta property="og:url" content="itc.edu.vn">
    <title>CĐ ITC Assistant</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css"
        integrity="sha512-5Hs3dF2AEPkpNAR7UiOHba+lRSJNeM2ECkwxUIxC1Q/FLycGTbNapWXB4tP889k5T5Ju8fs4b1P5z/iB4nMfSQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="icon" href="./image/logoitc.png">
    <link rel="stylesheet" href="./css/style.css">
    <script src="https://cse.google.com/cse.js?cx=3092bb157654b418d"></script>
    <script src="https://code.responsivevoice.org/responsivevoice.js?key=pSLGyR46"></script>
    <script src="https://crypto-js.googlecode.com/svn/tags/3.1.9-1/build/rollups/aes.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
</head>

<body>
    <div class="bg">
        <div class="chat-container">
            <div class="chat-header">
                <div class="tt-chat">
                    <img src="./image/logoitc.png" alt="" width="40px">
                    <div style="display: flex; flex-direction: column;">
                        <p class="tendv">CĐ CNTT TP.HCM</p>
                        <div style="display: flex; gap: 5px;">
                            <!-- <div id="datetime" style="font-size: 10px;font-style: italic;"></div> -->
                            <div id="weather" style="font-size: 10px;">Đang tải dữ liệu...</div>
                        </div>
                    </div>
                </div>
                <div class="bt-tn">
                    <button title="Liên hệ"><a href="tel:0938861080" style="color: #0d296b;"><i
                                class="fa-solid fa-phone"></i></a></button>
                    <button id="micButton" title="Mic trò chuyện" class="mic-effect" onclick="startDictation()"><i
                            class="fa-solid fa-microphone"></i></button>
                    <button title="Tìm kiếm GG" onclick="openSearchModal()"><i class="fa-solid fa-search"></i></button>
                </div>
            </div>
            <marquee behavior="" direction=""><a href="./test.html">Tra cứu</a> tra cứu kết quả</marquee>
            <div class="messages" id="messages"></div>
            <div class="typing" id="typing">
                <span>CĐ</span> <span>ITC</span>
                <span>đang</span> <span>trả</span> <span>lời</span><span>...</span>
            </div>
            <div class="input-area">
                <div class="nhap-tn" title="Nhập tin nhắn"><input placeholder="Nhập tin nhắn" type="text"
                        id="userInput">
                    <button title="Gửi tin nhắn" onclick="sendMessage(document.getElementById('userInput').value)"><i
                            class="fa-regular fa-paper-plane"></i></button>
                </div>
            </div>
        </div>
    </div>
    <div id="searchModal" class="modal">
        <div class="modal-content">
            <img src="../image/logoitc.png" alt="" width="50px">
            <span class="close" onclick="closeSearchModal()">&times;</span>
            <div class="gcse-searchbox-only"></div>
        </div>
    </div>
    </div>
    <script src="./js/tn-bot.js"></script>
    <script src="./js/mainbot.js"></script>
    <script src="./js/security.js"></script>
    <script>
        // function showDateTime() {
        //     const now = new Date();
        //     const day = now.getDate();
        //     const month = now.getMonth() + 1;
        //     const year = now.getFullYear();
        //     const hours = String(now.getHours()).padStart(2, '0');
        //     const minutes = String(now.getMinutes()).padStart(2, '0');
        //     const seconds = String(now.getSeconds()).padStart(2, '0');

        //     const currentDateTime = `${day}/${month}/${year} -${hours}:${minutes}:${seconds}`;
        //     document.getElementById('datetime').innerText = currentDateTime;
        // }

        // setInterval(showDateTime, 1000);
        // showDateTime();

        function fetchWeather(latitude, longitude) {
            fetch(`https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current_weather=true`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Có lỗi xảy ra!');
                    }
                    return response.json();
                })
                .then(data => {
                    const temperature = data.current_weather.temperature;
                    const description = data.current_weather.weathercode;
                    const weatherDescription = getWeatherDescription(description);
                    document.getElementById('weather').innerText = `${temperature}°C,${weatherDescription}`;
                })
                .catch(error => {
                    document.getElementById('weather').innerText = `Lỗi: ${error.message}`;
                });
        }

        function getWeatherDescription(code) {
            const descriptions = {
                0: "Trời quang",
                1: "Chủ yếu quang đãng",
                2: "Có mây từng phần",
                3: "Trời nhiều mây",
                45: "Sương mù",
                48: "Sương mù đóng băng",
                // Thêm các mã khác nếu cần
            };
            return descriptions[code] || "Không xác định";
        }

        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(position => {
                    const latitude = position.coords.latitude;
                    const longitude = position.coords.longitude;
                    fetchWeather(latitude, longitude);
                }, () => {
                    document.getElementById('weather').innerText = "Không thể lấy vị trí của bạn.";
                });
            } else {
                document.getElementById('weather').innerText = "Trình duyệt của bạn không hỗ trợ Geolocation.";
            }
        }

        getLocation();
    </script>
</body>

</html>